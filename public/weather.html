<!DOCTYPE html>
<html>

<head>
    <title>City Finder</title>
    <script src="http://code.jquery.com/jquery-3.2.1.min.js">
    </script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>

<body class="bg-light">
    <div class="container mt-5">
        <div class="row">
            <div class="col-sm-6">
                <div class="card" id="weatherCard">
                    <div class="card-header bg-primary text-white"><h3>Weather</h3></div>
                    <div class="card-body">
                        <label for="cityField">Enter A Utah City:</label>
                        <div class="form-group">
                            <form class="form-inline">
                                <input class="form-control" type="text" id="cityField">
                                <input class="btn btn-primary ml-2" id="weatherButton" type="submit" value="Submit">
                            </form>
                        </div>
                        <p>Suggestion: <span id="txtHint">Empty</span></p>

                        <label for="displayCity">City</label>
                        <div class="form-group">
                            <form class="form-inline">
                                <input class="form-control" placeholder="No City" id="displayCity">
                            </form>
                        </div>
                        <p>Current Weather</p>
                        <div id="weather">No weather</div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="card">
                    <div class="card-header bg-primary text-white"><h3>Definition Search</h3></div>
                    <div class="card-body">
<label for="stackfield">Enter A Word To Be Defined:</label>
<div class="form-group">              <form class="form-inline">
                                <input class="form-control" type="text" id="stackfield" value="">
                                <input class="btn btn-primary ml-2" id="stackButton" type="submit" value="Submit">
                            </form>
                        </div>
                        <label>Search Results:</label>
                        <span id="stackhint">Empty</span>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <script>
        $(document).ready(function() {
            $("#cityField").keyup(function() {
                var url = "getcity?q="+$("#cityField").val();
  $.getJSON(url,function(data) {
                        var everything;
                        everything = "<ul>";
                        console.log(data);
                        $.each(data, function(i, item) {
                            everything += "<li> " + data[i].city;
                        });
                        everything += "</ul>";
                        $("#txtHint").html(everything);
                    })
                    .done(function() { console.log('getJSON request succeeded!'); })
                    .fail(function(jqXHR, textStatus, errorThrown) {
                        console.log('getJSON request failed! ' + textStatus);
                        console.log("incoming " + jqXHR.responseText);
                    })
                    .always(function() {
                        console.log('getJSON request ended!');
                    });
            });
        });
        $('#weatherButton').click(function(e) {
            e.preventDefault();
            var city = $('#cityField').val();
            $('#displayCity').val(city);
            var myurl = "http://api.openweathermap.org/data/2.5/weather?units=imperial&q=" + city + "&APPID=b47631b87338026b362844e8771c78b6";
            $.ajax({
                url: myurl,
                dataType: "json",
                success: function(data) {
                    // var obj = $.parseJSON(data);
                    var everything;
                    everything = "<ul>";
                    everything += "<li> City: " + data.name + "</li>";
                    everything += "<li> Temperature: " + data.main.temp + "</li>";
                    everything += "<li> Weather: " + data.weather[0].description + "</li>";
                    everything += "</ul>";
                    $("#weather").html(everything);
                    if(data.main.temp > 50) {
                        $('#weatherCard').addClass("bg-warning");
                    }
                    else {
                        $('#weatherCard').addClass("bg-info");
                    }
                }
            });
        })

        $('#stackButton').click(function(e) {
            e.preventDefault();
            var search = $('#stackfield').val();
            var url = "owl?q="+search;
            $.ajax({
                url: url,
                dataType: "json",
                success: function(data) {
                    console.log(data);
                    var everything;
                    everything = "<ol class=\"list-group\">";
                    for (var i = 0; i < data.length; i++) {
                        everything += "<li class=\"list-group-item\">";
                        everything += "<ul>";
                        everything += "<li>Type: " + data[i].type + "</li>";
                        everything += "<li>Definition: " + data[i].defenition + "</li>";
                        everything += "<li> Example: " + data[i].example + "</li>";
                        everything += "</ul>";
                        everything += "</li>";
                    }
                    everything += "</ol>";
                    console.log(everything);
                    $("#stackhint").html(everything);
                }
            });
        })
    </script>
</body>

</html>
